<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASUS PM LAB - Wolf Huang Portfolio</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & Babel CDN -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap');
        body { font-family: 'Inter', 'PingFang TC', 'Microsoft JhengHei', sans-serif; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #cbd5e1; }
        .animate-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        textarea:focus { border-color: #4f46e5 !important; outline: none; box-shadow: 0 0 0 2px #e0e7ff; }
        .interactive-word:hover { background-color: #4f46e5; color: white; border-radius: 4px; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef, useCallback } = React;

        // --- Lucide Icon Component ---
        const Icon = ({ name, size = 20, className = "" }) => {
            useEffect(() => { if (window.lucide) window.lucide.createIcons(); }, [name]);
            return <i data-lucide={name} style={{ width: size, height: size }} className={className}></i>;
        };

        // --- Helper: PCM to WAV for TTS ---
        function pcmToWav(pcmBase64, sampleRate = 24000) {
            const byteCharacters = atob(pcmBase64);
            const byteNumbers = new Array(byteCharacters.length);
            for (let i = 0; i < byteCharacters.length; i++) { byteNumbers[i] = byteCharacters.charCodeAt(i); }
            const pcmData = new Uint8Array(byteNumbers);
            const buffer = new ArrayBuffer(44 + pcmData.length);
            const view = new DataView(buffer);
            const writeString = (offset, string) => { for (let i = 0; i < string.length; i++) { view.setUint8(offset + i, string.charCodeAt(i)); } };
            writeString(0, 'RIFF'); view.setUint32(4, 32 + pcmData.length, true); writeString(8, 'WAVE');
            writeString(12, 'fmt '); view.setUint32(16, 16, true); view.setUint16(20, 1, true); view.setUint16(22, 1, true);
            view.setUint32(24, sampleRate, true); view.setUint32(28, sampleRate * 2, true); view.setUint16(32, 2, true); view.setUint16(34, 16, true);
            writeString(36, 'data'); view.setUint32(40, pcmData.length, true);
            pcmData.forEach((byte, i) => view.setUint8(44 + i, byte));
            return new Blob([buffer], { type: 'audio/wav' });
        }

        const App = () => {
            const [activeTab, setActiveTab] = useState(0);
            const [isGenerating, setIsGenerating] = useState(false);
            const [isPlaying, setIsPlaying] = useState(null);
            const [notification, setNotification] = useState(null);
            const [playbackSpeed, setPlaybackSpeed] = useState(1.0);
            const [sheetUrl, setSheetUrl] = useState("");
            const [appsScriptUrl, setAppsScriptUrl] = useState("");
            const [userApiKey, setUserApiKey] = useState("");

            const currentApiKey = userApiKey || "";

            // --- 完整核心數據回歸 ---
            const [data, setData] = useState({
                intro: {
                    zh: `你好，我是黃詳淵 Wolf，一位 PMP 認證、擁有超過 14 年經驗的跨域專案與數位轉型工作者。我的核心專長是：在資源受限環境中理出路徑，將混亂建成可交付、可規模化的結構。\n\n我的職涯三階段：\n1. 音樂創業期：培養極強的行動力與從零到一的適應力。\n2. IT 服務業：深耕 C#、SQL 技術底層，並為製造業規劃數位轉型藍圖。\n3. PMO 治理：在 SoftBI 建立跨專案交付治理系統，將效能提升 6 倍。\n\n現在，我希望將這套在資源受限環境中磨出的能力帶到 ASUS，在電商 PM 角色放大全球影響力。`,
                    en: `Hi, I’m Wolf Huang, a PMP-certified professional with over 14 years of experience. My core strength is building structure in complex environments — turning chaos into scalable delivery systems. My career has three phases: music entrepreneurship, IT services, and PMO governance. I've completed the cycle from startup to scale and am ready to amplify my impact at ASUS.`
                },
                star: [
                    {
                        skill: "跨部門溝通與利害關係人管理 (PMO)",
                        zh: {
                            context: "在 SoftBI 擔任 PMO，管理 50+ 專案與 20+ 團隊，跨及產品、技術與業務端。",
                            action: "建立模組化管理實務與 AI 自動化週報系統，將原本需 3 小時的手動回報縮短至 30 分鐘，並確保 200 個任務精準派發。",
                            result: "成功讓專案進度可視化，溝通成本降低 60%，協助公司穩定進入產品交付擴大期。"
                        },
                        en: {
                            context: "At SoftBI, managed 50+ concurrent projects across 20 teams involving diverse stakeholders.",
                            action: "Developed a modular governance framework and AI-automated reporting, cutting weekly status cycles from 3 hours to 30 minutes.",
                            result: "Reduced cross-functional overhead by 60%, ensuring predictable delivery during the company's expansion phase."
                        }
                    },
                    {
                        skill: "需求分析與系統規劃 (PLM/CRM)",
                        zh: {
                            context: "在金上晉科技負責 PLM 系統導入，需整合研發到生產的數據邏輯。",
                            action: "繪製詳細的 Current/Future State 流程圖，定義零件 BOM 與品質循環數據流，並轉化為技術規格。",
                            result: "縮短數據同步路徑，提升供應商管理透明度，建立企業級異質系統整合範例。"
                        },
                        en: {
                            context: "Led PLM system implementation at GBJM Tech, integrating complex R&D and manufacturing data logic.",
                            action: "Mapped end-to-end process flow diagrams and defined technical requirements for Part BOM and Quality loops.",
                            result: "Shortened data synchronization paths and improved supplier management transparency through integrated system orchestration."
                        }
                    }
                ],
                homebase: [
                    {
                        q: "你的英文能力是否足以應付跨國工作？",
                        framework: "Split Framework (Passion -> AI -> Result)",
                        zh: "我雖然不是母語人士，但我對學習有極強熱情。2023 年 AI 問世時我就訂閱至今，我透過 Vibe Coding 與 AI 互動學會很多技術。這場面試的準備就是我自主學習能力的證明，我能精準運用商務術語進行專業溝通。",
                        en: "I leverage AI as a force multiplier for communication. Since 2023, I've used GenAI to master complex technical concepts through 'Vibe Coding.' This intensive preparation demonstrates my ability to achieve professional precision in global business English through adaptive, high-frequency learning."
                    },
                    {
                        q: "你缺乏純電商平台的直接經驗？",
                        framework: "Extended Path (Complexity -> Scale -> Value)",
                        zh: "華碩經營的是全球規模平台。挑戰在於『複雜性與規模化』。我過去在 SME 磨出的能力是從治理層面確保專案可預測性。比起單純電商背景，我更能處理總部與區域間的異質系統演進。",
                        en: "ASUS operates mission-critical platforms at a global magnitude. The real challenge is managing complexity and scale. My core value lies in governance and architectural thinking to ensure predictability across multi-region systems, aligning stakeholders across HQ and regional business units."
                    },
                    {
                        q: "缺乏在跨國公司的工作經驗？",
                        framework: "Seed & Growth (Seed -> Stage -> Action)",
                        zh: "過去在 SME 從 0 到 100 的經驗是一個種子。我了解到人生下個里程碑就是類似的路徑但更大的舞台。我會保持熱情並積極擁抱所有的 dots，將中小企業的靈活性與大公司的資源結合。",
                        en: "My experience in SMEs served as an intensive incubator for agility. I see ASUS as the natural next milestone—the same pathfinding logic but on a global stage. I am ready to connect my diverse experiences to drive large-scale impact."
                    }
                ],
                seei: [
                    {
                        topic: "我最大的缺點是什麼？",
                        zh: "我最大的缺點是早期較依賴個人直覺。但這促使我考取 PMP 認證，學習將『個人智慧』轉化為『組織資產』。現在我更傾向於建立流程（Governance）來降低風險並確保交付品質。",
                        en: "My weakness was once relying too much on individual intuition. To address this, I earned my PMP certification and now focus on building governance frameworks that transform personal insights into scalable organizational assets, ensuring consistent delivery quality."
                    },
                    {
                        topic: "我們為什麼該僱用你？",
                        zh: "因為我是一個能將『混亂轉化為結構』的開拓者（Pathfinder）。ASUS 正在推動 D2C 轉型，你們需要的不只是執行者，而是一個能同時理解代碼、業務目標並建立全球治理機制的橋樑。",
                        en: "You should hire me because I am a Pathfinder who excels at creating structure out of chaos. As ASUS drives D2C transformation, you need a strategic bridge who speaks both code and business while building robust global governance."
                    },
                    {
                        topic: "你的工作風格是什麼？",
                        zh: "我提供強力的『三合一連擊』：動手解決問題的技術力；跨部門領導力；以及 PMP 規模化治理。我追求『敏捷探索路徑，標準化規模影響』。",
                        en: "I offer a powerful three-point combo: hands-on technical problem-solving, cross-functional leadership, and PMP-driven scalable governance to ensure predictable, data-driven delivery."
                    }
                ],
                reverse_qs: [
                    { zh: "ASUS Store 未來在 B2B (CRM) 與 D2C 的整合戰略中，最大的技術挑戰是什麼？", en: "What is the biggest technical challenge in integrating B2B CRM and D2C strategies for the future ASUS Store?" },
                    { zh: "在全球網站架構下，如何權衡『全球統一標準』與『單一地區的特殊需求』？", en: "How do you balance global standardization with localized regional requirements in your web architecture?" },
                    { zh: "目前 ASUS AI Hub 如何具體賦能給電商端的專案管理？", en: "How does the ASUS AI Hub currently empower project management within the eCommerce sector?" },
                    { zh: "團隊目前如何定義電商 PM 在『產品生命週期管理 (PLM)』與『銷售端』之間的銜接角色？", en: "How is the connection between PLM and sales defined for eCommerce PMs in your current workflow?" },
                    { zh: "在多區域營運中，如何確保 Magento 平台的擴張性與各國支付合規的平衡？", en: "How do you ensure Magento's scalability while maintaining payment and legal compliance across different regions?" },
                    { zh: "公司對於 D2C 數據應用在產品研發回饋（Feedback Loop）上有什麼樣的期待？", en: "What are the expectations for using D2C data to create a feedback loop for product R&D?" },
                    { zh: "團隊如何看待 Vibe Coding 工具在提升前端開發與測試效率上的應用？", en: "How does the team view the application of Vibe Coding tools in enhancing frontend development and testing efficiency?" },
                    { zh: "針對高客單價的 3C 產品，ASUS 如何透過 CRM 提升用戶的回購率？", en: "For high-ticket 3C products, how does ASUS leverage CRM to improve customer loyalty and repurchase rates?" },
                    { zh: "在跨國協作中，總部 PM 如何有效地協助 Regional PM 處理當地的 First-line 需求？", en: "How does HQ effectively support Regional PMs in handling localized first-line requirements?" },
                    { zh: "ASUS 正在推動的『Ubiquitous AI』願景，具體會如何改變電商消費者的購物旅程？", en: "How will the 'Ubiquitous AI' vision specifically transform the customer shopping journey on your eCommerce platform?" }
                ],
                vocabulary: []
            });

            // --- 核心方法定義 ---
            const notify = (msg, type = 'success') => { setNotification({ message: msg, type }); setTimeout(() => setNotification(null), 3000); };

            const speak = async (text, id) => {
                if (!currentApiKey) { notify("請填寫 API Key", "error"); return; }
                if (isPlaying) return; setIsPlaying(id);
                try {
                    const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${currentApiKey}`, {
                        method: 'POST', headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ contents: [{ parts: [{ text: `Say clearly at speed ${playbackSpeed}: ${text}` }] }], generationConfig: { responseModalities: ["AUDIO"], speechConfig: { voiceConfig: { prebuiltVoiceConfig: { voiceName: "Kore" } } } } })
                    });
                    const json = await res.json();
                    const pcm = json.candidates[0].content.parts[0].inlineData.data;
                    if (pcm) {
                        const wav = pcmToWav(pcm); const audio = new Audio(URL.createObjectURL(wav));
                        audio.playbackRate = playbackSpeed; audio.onended = () => setIsPlaying(null); audio.play();
                    }
                } catch (e) { setIsPlaying(null); notify("語音讀取失敗", "error"); }
            };

            const askAI = async (prompt, system) => {
                const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${currentApiKey}`, {
                    method: 'POST', headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }], systemInstruction: { parts: [{ text: system }] } })
                });
                return await res.json();
            };

            const addSpecificWord = async (word) => {
                const clean = word.toLowerCase().replace(/[^a-z]/g, "");
                if (clean.length < 3) return;
                notify(`加入收藏: ${clean}...`, 'info'); setIsGenerating(true);
                try {
                    const res = await askAI(`Define "${clean}" for PM interview. Traditional Chinese. JSON {word, zh, desc, difficulty_score}`, "JSON only.");
                    const json = JSON.parse(res.candidates[0].content.parts[0].text.replace(/```json|```/g, ''));
                    const newData = { ...data };
                    const idx = newData.vocabulary.findIndex(v => v.word.toLowerCase() === clean);
                    if (idx > -1) newData.vocabulary[idx].count += 1; else newData.vocabulary.push({ ...json, count: 1 });
                    newData.vocabulary.sort((a,b) => b.difficulty_score - a.difficulty_score);
                    setData(newData); notify(`「${clean}」收藏成功！`);
                } catch (e) {} setIsGenerating(false);
            };

            const syncEnglish = async (section, index = null) => {
                if (!currentApiKey) { notify("請填寫 API Key", "error"); return; }
                setIsGenerating(true);
                let prompt = "";
                const system = "Professional executive English translator. Return ONLY the translated text. No preamble, no choices.";
                if (section === 'intro') prompt = `Translate to business English: ${data.intro.zh}`;
                else if (section === 'star') prompt = `Translate this STAR JSON to English: ${JSON.stringify(data.star[index].zh)}`;
                else if (section === 'homebase') prompt = `Translate this response: ${data.homebase[index].zh}`;
                else if (section === 'seei') prompt = `Translate this SEEI JSON: ${JSON.stringify(data.seei[index])}`;
                else if (section === 'reverse') prompt = `Translate: ${data.reverse_qs[index].zh}`;

                try {
                    const res = await askAI(prompt, system);
                    const text = res.candidates[0].content.parts[0].text.trim();
                    const newData = { ...data };
                    if (section === 'intro') newData.intro.en = text;
                    else if (section === 'star') newData.star[index].en = JSON.parse(text.replace(/```json|```/g, ''));
                    else if (section === 'homebase') newData.homebase[index].en = text;
                    else if (section === 'seei') { const p = JSON.parse(text.replace(/```json|```/g, '')); newData.seei[index].en = p.en || text; }
                    else if (section === 'reverse') newData.reverse_qs[index].en = text;
                    setData(newData); notify("AI 同步成功");
                } catch (e) { notify("同步解析失敗", "error"); }
                setIsGenerating(false);
            };

            // --- 核心單字庫功能 (Pull/Overwrite & Enrich) ---
            const pullFromCloud = async () => {
                if (!appsScriptUrl) { notify("請輸入 API URL", "error"); return; }
                notify("正在拉取並覆蓋數據...", "info");
                try {
                    const res = await fetch(appsScriptUrl + "?action=pull");
                    const cloudData = await res.json();
                    if (Array.isArray(cloudData)) {
                        setData(prev => ({ ...prev, vocabulary: cloudData }));
                        notify("雲端數據已覆蓋本地！");
                    }
                } catch (e) { notify("拉取失敗", "error"); }
            };

            const syncToCloud = async () => {
                if (!appsScriptUrl) { notify("請輸入 API URL", "error"); return; }
                notify("上傳數據中...", "info");
                try {
                    await fetch(appsScriptUrl, { method: 'POST', mode: 'no-cors', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ action: "push", data: data.vocabulary }) });
                    notify("同步指令已送出");
                } catch (e) { notify("上傳失敗", "error"); }
            };

            const enrichVocabulary = async () => {
                const targets = data.vocabulary.filter(v => !v.zh || !v.desc || v.zh === "N/A");
                if (targets.length === 0) { notify("數據已完整，無需補全", "info"); return; }
                setIsGenerating(true);
                notify(`正在補全 ${targets.length} 個釋義...`, 'info');
                try {
                    const wordList = targets.map(t => t.word).join(", ");
                    const res = await askAI(`Define these words for ASUS PM: ${wordList}. JSON array [{word, zh, desc, difficulty_score}]. Use Traditional Chinese.`, "JSON only.");
                    const enriched = JSON.parse(res.candidates[0].content.parts[0].text.replace(/```json|```/g, ''));
                    const newData = { ...data };
                    enriched.forEach(item => {
                        const idx = newData.vocabulary.findIndex(v => v.word.toLowerCase() === item.word.toLowerCase());
                        if (idx > -1) newData.vocabulary[idx] = { ...newData.vocabulary[idx], ...item };
                    });
                    setData(newData); notify("補全成功！");
                } catch (e) {} setIsGenerating(false);
            };

            const generateVocabulary = async () => {
                setIsGenerating(true);
                const allEn = [data.intro.en, ...data.star.flatMap(s => [s.en.context, s.en.action, s.en.result]), ...data.homebase.map(h => h.en), ...data.seei.map(s => s.en), ...data.reverse_qs.map(r => r.en)].join(" ");
                const clean = allEn.toLowerCase().replace(/[^a-z ]/g, "").split(/\s+/);
                const existing = new Set(data.vocabulary.map(v => v.word.toLowerCase()));
                const freq = {}; clean.forEach(w => { if (w.length > 5) freq[w] = (freq[w] || 0) + 1; });
                const candidates = Object.keys(freq).filter(w => !existing.has(w));
                if (candidates.length === 0) { setIsGenerating(false); notify("清單已是最新", "info"); return; }
                try {
                    const res = await askAI(`Extract 10 PM keywords from: ${candidates.slice(0, 15).join(",")}. JSON array [{word, zh, desc, difficulty_score}]. Traditional Chinese.`, "JSON only.");
                    const json = JSON.parse(res.candidates[0].content.parts[0].text.replace(/```json|```/g, ''));
                    const newData = { ...data };
                    json.forEach(i => { i.count = freq[i.word.toLowerCase()] || 1; newData.vocabulary.push(i); });
                    newData.vocabulary.sort((a,b) => b.difficulty_score - a.difficulty_score);
                    setData(newData); notify(`追加了 ${json.length} 個單字`);
                } catch (e) {} setIsGenerating(false);
            };

            const InteractiveText = ({ text }) => {
                if (!text) return null;
                return (
                    <div className="leading-relaxed text-base">
                        {text.split(/(\s+|[,.;:!?()])/).map((part, i) => {
                            if (/^[a-zA-Z]{3,}$/.test(part)) {
                                return <span key={i} onClick={() => addSpecificWord(part)} className="cursor-pointer border-b border-dashed border-indigo-200 interactive-word px-0.5 transition-all">{part}</span>;
                            }
                            return <span key={i}>{part}</span>;
                        })}
                    </div>
                );
            };

            const tabs = [
                { name: "自我介紹", icon: "user" },
                { name: "STAR 範例", icon: "star" },
                { name: "困難問題", icon: "shield-alert" },
                { name: "SEE-I 模型", icon: "message-square" },
                { name: "關鍵反問", icon: "help-circle" },
                { name: "核心單字", icon: "book-open" }
            ];

            return (
                <div className="min-h-screen flex flex-col md:flex-row bg-slate-50">
                    {/* Sidebar */}
                    <nav className="w-full md:w-72 bg-white border-r border-slate-200 p-6 flex flex-col h-screen sticky top-0 overflow-y-auto z-20 shadow-sm">
                        <div className="mb-6">
                            <h1 className="text-2xl font-black text-indigo-700 tracking-tighter uppercase">ASUS PM LAB</h1>
                            <p className="text-[10px] text-slate-400 font-bold uppercase mt-1 tracking-widest italic">Wolf Huang Portfolio v6.3</p>
                        </div>

                        <div className="space-y-4 mb-6">
                            <div className="bg-slate-50 p-4 rounded-2xl border border-slate-100 shadow-inner">
                                <div className="flex items-center gap-2 mb-2 text-indigo-600 font-black text-[10px] uppercase tracking-tighter"><Icon name="key" size={14}/> Gemini API Key</div>
                                <input type="password" placeholder="填寫 Key 以啟用 AI..." className="w-full text-[11px] p-2.5 rounded-xl border border-slate-200 outline-none focus:ring-2 focus:ring-indigo-100 bg-white" value={userApiKey} onChange={(e) => setUserApiKey(e.target.value)} />
                            </div>
                            <div className="bg-slate-50 p-4 rounded-2xl border border-slate-100">
                                <div className="flex items-center gap-2 mb-3 text-indigo-600 font-black text-[10px] uppercase"><Icon name="gauge" size={14}/> Speed Control</div>
                                <div className="grid grid-cols-5 gap-1">
                                    {[0.5, 0.75, 1.0, 1.25, 1.5].map(s => (
                                        <button key={s} onClick={() => setPlaybackSpeed(s)} className={`text-[10px] font-bold py-2 rounded-lg transition-all ${playbackSpeed === s ? "bg-indigo-600 text-white shadow-md" : "bg-white text-slate-400 hover:bg-slate-50"}`}>{s}x</button>
                                    ))}
                                </div>
                            </div>
                            <div className="bg-indigo-50/50 p-4 rounded-2xl border border-indigo-100">
                                <div className="flex items-center gap-2 mb-2 text-indigo-700 font-black text-[10px] uppercase tracking-tighter"><Icon name="cloud" size={14}/> Cloud Sync</div>
                                <input type="password" placeholder="Apps Script URL..." className="w-full text-[10px] p-2 rounded-lg border border-indigo-100 outline-none focus:ring-1 focus:ring-indigo-400" value={appsScriptUrl} onChange={(e) => setAppsScriptUrl(e.target.value)} />
                                {sheetUrl && <input type="text" placeholder="Sheet URL..." className="w-full text-[10px] p-2 mt-2 rounded border-indigo-100" value={sheetUrl} onChange={(e) => setSheetUrl(e.target.value)} />}
                            </div>
                        </div>

                        {tabs.map((tab, idx) => (
                            <button key={idx} onClick={() => setActiveTab(idx)} className={`flex items-center gap-3 px-4 py-3 rounded-xl transition-all mb-1 ${activeTab === idx ? "bg-indigo-600 text-white shadow-lg" : "hover:bg-slate-50 text-slate-500"}`}>
                                <Icon name={tab.icon} size={18} />
                                <span className="font-bold text-sm">{tab.name}</span>
                            </button>
                        ))}
                    </nav>

                    {/* Main Content */}
                    <main className="flex-1 p-4 md:p-10 lg:p-12 overflow-y-auto">
                        <div className="max-w-4xl mx-auto space-y-12 pb-32">
                            {notification && (
                                <div className="fixed bottom-8 right-8 z-50 flex items-center gap-3 px-6 py-4 bg-white border border-indigo-100 rounded-3xl shadow-2xl animate-in">
                                    <Icon name={notification.type === 'success' ? 'check-circle' : 'loader'} size={18} className={notification.type === 'success' ? 'text-emerald-500' : 'text-indigo-500'} />
                                    <span className="font-bold text-sm text-slate-700">{notification.message}</span>
                                </div>
                            )}

                            {/* Section: 自我介紹 */}
                            {activeTab === 0 && (
                                <div className="animate-in space-y-6">
                                    <div className="flex justify-between items-end border-b-2 border-indigo-600 pb-3">
                                        <h2 className="text-3xl font-black text-slate-800 tracking-tighter">自我介紹</h2>
                                        <button onClick={() => syncEnglish('intro')} className="text-xs font-bold text-slate-400 hover:text-indigo-600 flex items-center gap-1 transition-all"><Icon name="refresh-cw" size={16}/> AI Sync</button>
                                    </div>
                                    <div className="grid md:grid-cols-2 gap-6">
                                        <div className="bg-white p-5 rounded-[1.5rem] border border-slate-200 shadow-sm focus-within:ring-2 focus-within:ring-indigo-100 transition-all">
                                            <textarea className="w-full h-[320px] bg-transparent border-none focus:ring-0 text-slate-700 text-base p-0 resize-none outline-none leading-relaxed font-medium" value={data.intro.zh} onChange={(e) => setData({...data, intro: {...data.intro, zh: e.target.value}})} />
                                        </div>
                                        <div className="bg-indigo-50/50 p-5 rounded-[1.5rem] border border-indigo-100 flex flex-col min-h-[320px]">
                                            <div className="flex justify-between items-start mb-4">
                                                <span className="text-[8px] font-black text-indigo-400 uppercase tracking-widest text-base">Script (EN)</span>
                                                <button onClick={() => speak(data.intro.en, 'intro')} className="p-1.5 bg-white shadow rounded text-slate-400 hover:text-indigo-600 transition-all"><Icon name="play" size={14} fill="currentColor"/></button>
                                            </div>
                                            <div className="text-slate-700 italic font-bold leading-relaxed overflow-y-auto"><InteractiveText text={data.intro.en} /></div>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Section: STAR */}
                            {activeTab === 1 && (
                                <div className="animate-in space-y-12">
                                    <h2 className="text-3xl font-black text-slate-800 italic uppercase">STAR Evidence</h2>
                                    {data.star.map((item, idx) => (
                                        <div key={idx} className="space-y-6">
                                            <div className="flex items-center justify-between border-b-2 border-indigo-600 pb-3">
                                                <h3 className="text-2xl font-black text-indigo-800 tracking-tight">{item.skill}</h3>
                                                <button onClick={() => syncEnglish('star', idx)} className="text-xs font-bold text-slate-400 hover:text-indigo-600 flex items-center gap-1 transition-all"><Icon name="refresh-cw" size={16}/> AI Sync</button>
                                            </div>
                                            {['context', 'action', 'result'].map(part => (
                                                <div key={part} className="grid md:grid-cols-2 gap-6">
                                                    <div className="bg-white p-5 rounded-[1.5rem] border border-slate-200 shadow-sm focus-within:ring-2 focus-within:ring-indigo-100 transition-all shadow-sm">
                                                        <span className="text-[8px] font-black text-indigo-400 uppercase tracking-widest block mb-2">{part} (ZH)</span>
                                                        <textarea className="w-full bg-transparent border-none focus:ring-0 text-slate-600 text-base p-0 resize-none outline-none leading-relaxed font-medium" rows={2} value={item.zh[part]} onChange={(e) => { const newData = {...data}; newData.star[idx].zh[part] = e.target.value; setData(newData); }} />
                                                    </div>
                                                    <div className="bg-indigo-50/50 p-5 rounded-[1.5rem] border border-indigo-100 flex items-start gap-4">
                                                        <button onClick={() => speak(item.en[part], `star-${idx}-${part}`)} className={`mt-1 flex-shrink-0 transition-colors ${isPlaying === `star-${idx}-${part}` ? 'text-indigo-600' : 'text-slate-300 hover:text-indigo-400'}`}><Icon name="mic-2" size={18}/></button>
                                                        <div className="text-slate-700 italic font-bold leading-relaxed text-base"><InteractiveText text={item.en[part]} /></div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    ))}
                                </div>
                            )}

                            {/* Section: 困難問題 */}
                            {activeTab === 2 && (
                                <div className="animate-in space-y-12">
                                    <h2 className="text-3xl font-black text-slate-800 uppercase tracking-tighter">困難問題策略</h2>
                                    {data.homebase.map((hb, idx) => (
                                        <div key={idx} className="space-y-6">
                                            <div className="flex items-center justify-between border-b-2 border-indigo-600 pb-3">
                                                <h3 className="text-xl font-bold text-indigo-800">{hb.q}</h3>
                                                <button onClick={() => syncEnglish('homebase', idx)} className="text-xs font-bold text-slate-400 hover:text-indigo-600 flex items-center gap-1 transition-all"><Icon name="refresh-cw" size={16}/> AI Sync</button>
                                            </div>
                                            <div className="grid md:grid-cols-2 gap-6">
                                                <div className="bg-white p-5 rounded-[1.5rem] border border-slate-200 shadow-sm focus-within:ring-2 focus-within:ring-indigo-100">
                                                    <span className="text-[8px] font-black text-indigo-400 uppercase tracking-widest block mb-2">回應 (中)</span>
                                                    <textarea className="w-full h-48 bg-transparent border-none focus:ring-0 text-slate-700 text-base p-0 resize-none outline-none leading-relaxed font-medium" value={hb.zh} onChange={(e) => { const newData = {...data}; newData.homebase[idx].zh = e.target.value; setData(newData); }} />
                                                </div>
                                                <div className="bg-indigo-50/50 p-5 rounded-[1.5rem] border border-indigo-100 flex flex-col min-h-[192px]">
                                                    <div className="flex justify-between items-start mb-4">
                                                        <span className="text-[8px] font-black text-indigo-400 uppercase tracking-widest text-base">Defense (EN)</span>
                                                        <button onClick={() => speak(hb.en, `hb-${idx}`)} className="p-1.5 bg-white shadow rounded text-slate-400 hover:text-indigo-600"><Icon name="play" size={14} fill="currentColor"/></button>
                                                    </div>
                                                    <div className="text-slate-700 italic font-bold leading-relaxed text-base"><InteractiveText text={hb.en} /></div>
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}

                            {/* Section: SEE-I 模型 */}
                            {activeTab === 3 && (
                                <div className="animate-in space-y-12">
                                    <h2 className="text-3xl font-black text-slate-800 uppercase italic tracking-tighter">SEE-I Framework</h2>
                                    {data.seei.map((s, idx) => (
                                        <div key={idx} className="space-y-6">
                                            <div className="flex items-center justify-between border-b-2 border-indigo-600 pb-3">
                                                <h3 className="text-xl font-bold text-indigo-800 tracking-tight">{s.topic}</h3>
                                                <button onClick={() => syncEnglish('seei', idx)} className="text-xs font-bold text-slate-400 hover:text-indigo-600 flex items-center gap-1 transition-all"><Icon name="refresh-cw" size={16}/> AI Sync</button>
                                            </div>
                                            <div className="grid md:grid-cols-2 gap-6">
                                                <div className="bg-white p-5 rounded-[1.5rem] border border-slate-200 shadow-sm focus-within:ring-2 focus-within:ring-indigo-100 transition-all">
                                                    <span className="text-[8px] font-black text-indigo-400 uppercase tracking-widest block mb-2">陳述 (中)</span>
                                                    <textarea className="w-full h-48 bg-transparent border-none focus:ring-0 text-slate-700 text-base p-0 resize-none outline-none leading-relaxed font-medium" value={s.zh} onChange={(e) => { const newData = {...data}; newData.seei[idx].zh = e.target.value; setData(newData); }} />
                                                </div>
                                                <div className="bg-indigo-50/50 p-5 rounded-[1.5rem] border border-indigo-100 flex flex-col min-h-[192px]">
                                                    <div className="flex justify-between items-start mb-4">
                                                        <span className="text-[8px] font-black text-indigo-400 uppercase tracking-widest text-base">Statement (EN)</span>
                                                        <button onClick={() => speak(s.en, `seei-${idx}`)} className="p-1.5 bg-white shadow rounded text-slate-400 hover:text-indigo-600 transition-all"><Icon name="play" size={14} fill="currentColor"/></button>
                                                    </div>
                                                    <div className="text-slate-700 italic font-bold leading-relaxed text-base overflow-y-auto"><InteractiveText text={s.en} /></div>
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}

                            {/* Section: 關鍵反問 */}
                            {activeTab === 4 && (
                                <div className="animate-in space-y-10">
                                    <div className="flex justify-between items-center border-b-2 border-indigo-600 pb-3">
                                        <h2 className="text-3xl font-black text-slate-800 tracking-tighter">關鍵反問</h2>
                                        <button onClick={() => { const newData = {...data}; newData.reverse_qs.push({ zh: "新戰略問題...", en: "New Question..." }); setData(newData); }} className="bg-indigo-600 text-white px-5 py-2.5 rounded-xl shadow-lg flex items-center gap-2 hover:scale-105 transition-all text-sm font-bold"><Icon name="plus" size={18}/> 新增問題</button>
                                    </div>
                                    <div className="space-y-6">
                                        {data.reverse_qs.map((rq, idx) => (
                                            <div key={idx} className="grid md:grid-cols-2 gap-6 group animate-in">
                                                <div className="bg-white p-5 rounded-[1.5rem] border border-slate-200 shadow-sm flex flex-col gap-2 focus-within:ring-2 focus-within:ring-indigo-100 transition-all shadow-sm">
                                                    <div className="flex justify-between items-center">
                                                        <span className="text-[8px] font-black text-indigo-400 uppercase tracking-widest">Q {idx+1} (ZH)</span>
                                                        <button onClick={() => { const newData = {...data}; newData.reverse_qs.splice(idx, 1); setData(newData); }} className="text-slate-300 hover:text-rose-500 opacity-0 group-hover:opacity-100 transition-all"><Icon name="trash-2" size={14}/></button>
                                                    </div>
                                                    <textarea className="w-full bg-transparent border-none focus:ring-0 text-slate-700 font-bold text-base p-0 resize-none outline-none leading-relaxed" rows={2} value={rq.zh} onChange={(e) => { const newData = {...data}; newData.reverse_qs[idx].zh = e.target.value; setData(newData); }} />
                                                    <button onClick={() => syncEnglish('reverse', idx)} className="text-[9px] font-black text-indigo-500 uppercase hover:underline self-start mt-1">Sync EN</button>
                                                </div>
                                                <div className="bg-indigo-50/50 p-5 rounded-[1.5rem] border border-indigo-100 flex flex-col justify-center relative min-h-[100px]">
                                                    <div className="absolute top-4 right-4">
                                                        <button onClick={() => speak(rq.en, `rq-${idx}`)} className="text-slate-300 hover:text-indigo-600 transition-all"><Icon name="mic-2" size={18}/></button>
                                                    </div>
                                                    <div className="text-slate-700 italic font-bold leading-relaxed text-base pr-10"><InteractiveText text={rq.en} /></div>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}

                            {/* Section: 核心單字庫 */}
                            {activeTab === 5 && (
                                <div className="animate-in space-y-10">
                                    <div className="flex flex-col md:flex-row justify-between items-start md:items-end gap-6 border-b-2 border-indigo-600 pb-3">
                                        <h2 className="text-3xl font-black text-slate-800 tracking-tighter">核心單字庫</h2>
                                        <div className="flex items-center gap-2 flex-wrap">
                                            {sheetUrl && <a href={sheetUrl} target="_blank" className="bg-white border border-slate-200 text-slate-600 px-4 py-2 rounded-xl text-[11px] font-bold flex items-center gap-2 hover:bg-slate-50 transition-all shadow-sm"><Icon name="external-link" size={14}/> Sheet</a>}
                                            <button onClick={pullFromCloud} className="bg-emerald-50 text-emerald-700 px-4 py-2 rounded-xl border border-emerald-100 font-bold text-[11px] flex items-center gap-2 shadow-sm"><Icon name="download-cloud" size={14}/> Pull (覆蓋)</button>
                                            <button onClick={syncToCloud} className="bg-indigo-50 text-indigo-700 px-4 py-2 rounded-xl border border-indigo-100 font-bold text-[11px] flex items-center gap-2 shadow-sm"><Icon name="upload-cloud" size={14}/> Push (追加)</button>
                                            <button onClick={enrichVocabulary} className="bg-amber-50 text-amber-700 px-4 py-2 rounded-xl border border-amber-100 font-bold text-[11px] flex items-center gap-2 shadow-sm"><Icon name="wand-2" size={14}/> AI 補全釋義</button>
                                            <button onClick={generateVocabulary} className="bg-indigo-600 text-white px-5 py-2 rounded-xl shadow-lg font-bold text-[11px] flex items-center gap-2 transition-all hover:bg-indigo-700"><Icon name="refresh-cw" size={14} className={isGenerating ? "animate-spin" : ""}/> Scan Script</button>
                                        </div>
                                    </div>
                                    <div className="bg-white rounded-[2rem] border border-slate-200 overflow-hidden shadow-sm divide-y divide-slate-100 max-h-[800px] overflow-y-auto custom-scrollbar">
                                        {data.vocabulary.length > 0 ? data.vocabulary.map((v, idx) => (
                                            <div key={idx} className="p-8 flex flex-col md:flex-row items-start gap-8 group hover:bg-indigo-50/30 transition-colors animate-in">
                                                <div className="w-full md:w-52 flex-shrink-0">
                                                    <div className="flex items-center gap-3 mb-2">
                                                        <span className="text-2xl font-black text-slate-800 break-words tracking-tight">{v.word}</span>
                                                        <button onClick={() => speak(v.word, `v-${idx}`)} className="text-slate-300 group-hover:text-indigo-600 transition-all"><Icon name="volume-2" size={20}/></button>
                                                    </div>
                                                    <div className="flex items-center gap-2 mb-3 text-[10px] font-black uppercase tracking-widest">
                                                        <Icon name="trending-up" size={10} className="text-indigo-600"/>
                                                        <span className="text-slate-400">Freq: {v.count || 1}</span>
                                                        <span className="text-indigo-700 ml-auto font-bold bg-indigo-50 px-2 py-0.5 rounded">{v.zh || "N/A"}</span>
                                                    </div>
                                                    <button onClick={() => { const newData = { ...data }; newData.vocabulary.splice(idx, 1); setData(newData); }} className="text-[9px] text-rose-300 hover:text-rose-600 font-black uppercase tracking-widest opacity-0 group-hover:opacity-100 transition-all">Remove</button>
                                                </div>
                                                <div className="flex-1 bg-slate-50 p-6 rounded-[1.5rem] relative group/desc border border-transparent group-hover:border-indigo-100 shadow-inner min-h-[100px]">
                                                    <div className="absolute top-4 right-4 flex gap-2">
                                                        {v.difficulty_score && <div className="flex gap-0.5">{[...Array(10)].map((_, i) => (<div key={i} className={`w-2.5 h-1 rounded-full ${i < v.difficulty_score ? 'bg-orange-500' : 'bg-slate-200'}`} />))}</div>}
                                                        <button onClick={() => speak(v.desc, `v-desc-${idx}`)} className="p-1.5 bg-white shadow-sm rounded-lg text-slate-300 hover:text-indigo-600 opacity-0 group-hover/desc:opacity-100 transition-all"><Icon name="play" size={14} fill="currentColor"/></button>
                                                    </div>
                                                    <p className="text-base text-slate-600 italic font-semibold leading-relaxed pr-12">{v.desc || "請點擊「AI 補全釋義」生成描述。"}</p>
                                                </div>
                                            </div>
                                        )) : <div className="p-32 text-center text-slate-300 italic flex flex-col items-center gap-4"><Icon name="book-open" size={64} className="opacity-10"/><p>清單為空。點擊英文腳本單字即可收藏。</p></div>}
                                    </div>
                                </div>
                            )}
                        </div>
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
